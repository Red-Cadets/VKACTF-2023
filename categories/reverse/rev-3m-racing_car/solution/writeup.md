# Malware

|   C–æ–±—ã—Ç–∏–µ   | –ù–∞–∑–≤–∞–Ω–∏–µ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
| :---------: | :------: | :-------: | :-------: |
| VKACTF 2023 |  Racing car  |  Reverse  |  –°—Ä–µ–¥–Ω—è—è  |

## –û–ø–∏—Å–∞–Ω–∏–µ

>–ê–≤—Ç–æ—Ä: [Prokuror]
>
>ü†ñ - –≤–ø—Ä–∞–≤–æ, ü†î - –≤–ª–µ–≤–æ, ü†ï - –≤–ø–µ—Ä–µ–¥, ü†ó - –Ω–∞–∑–∞–¥, Q - –≤—ã–π—Ç–∏, ...
# –†–µ—à–µ–Ω–∏–µ

–ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É, –ø—ã—Ç–∞–µ–º—Å—è –≤—ã–∏–≥—Ä–∞—Ç—å, –Ω–æ –∏–≥—Ä–∞—Ç—å –º–æ–∂–Ω–æ –æ—á–µ–Ω—å –¥–æ–ª–≥–æ

–ï—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ –∫ —Ç–∞—Å–∫–µ, —Ç–æ –º–æ–∂–Ω–æ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è –æ –∫–∞–∫–æ–º-—Ç–æ –ª–∏—à–Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ

–ù–∞—Ö–æ–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à `sf::Keyboard::isKeyPressed` –∏–∑ [SFML](https://www.sfml-dev.org/index.php) –∏ —Å—Ä–∞–∑—É –ø–æ—Å–º–æ—Ç—Ä–∏–º –≥–¥–µ –æ–Ω–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

![IDA](img/1.png)

–í–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ –≤ `cp::GameSimulator::handle_input` —Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ, –Ω–∞—Ö–æ–¥–∏–º —Å—Ç—Ä–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

![funk](img/2.png)

–ï—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
1) –ó–∞–ø–∞—Ç—á–∏—Ç—å, –∞ —ç—Ç–æ –Ω–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç—Ä—É–¥–∞
2) –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∂–µ –∑–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Å—è –ø–æ [—Å—Å—ã–ª–∫–µ](https://www.sfml-dev.org/documentation/2.5.1/classsf_1_1Keyboard.php)

![arg](img/3.png)

–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ:
5 - F
11 - L
0 - A
6 - G

–ó–Ω–∞—á–∏—Ç –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞–∂–∞—Ç—ã –∫–ª–∞–≤–∏—à–∏ —Å –±—É–∫–≤–∞–º–∏ `F` `L` `A` `G`

–ü—Ä–æ–±—É–µ–º –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥ –≤ –∫–æ–Ω—Å–æ–ª–∏

![car](img/4.png)
### –§–ª–∞–≥

```
vka{KEYbOaRD_R4c1N6_mONsTER}
```

