# ВКАзино

|   Cобытие   | Название | Категория | Сложность |
| :---------: | :------: | :-------: | :-------: |
| VKACTF 2023 |  ВКАзино  |  Pwn  |  Средняя  |

## Описание

>Автор: old3gg, Ent3rG0dM0d3
>
>"Ка..зи.. чтооо? Стой, в такие места нам - обычным горожанам вход запрещен. Стражники следят за порядком и жестоко наказывают нарушителей, чьи лица были замечены в азартных местах. Но для тебя мы сделаем исключение. Только тсссc, никому не говори, что ты был здесь!"

# Решение

Дан 64-битный исполняемый файл, изучив который, можно увидеть следующее. Доступ к флагу можно получить, обменяв секретный ключ, который необходимо достать из функции gambling1(). Начнем попорядку:
1. Для того, чтобы сыграть в gambling1(), твой баланс должен быть = 13337. Для этого воспользуемся функцией top_up(), в которой можно получить необходимый нам для игры баланс.
- В функции top_up() происходит шифрование с помощью RSA(параметры генерируются случайным образом), но мы можем контролировать параметр "e", через уязвимость переполнения буфера. Таким образом зашифруя "13337" с "e" = 1, получим необходимый для игры баланс;
2. Далее изучим функцию gambling1(). На лицо уязвимость форматной строки, которая и поможет нам повлиять на переменную для доступа к секретному ключу.
- В функции происходит генерация случайного числа от 1 до 99, но для победы этого недостаточно(требуемая переменная должна , быть равна "101"). Слова джина помогут сформировать необходимую нагрузку ((длина текста джина + X) % 255 == 101), где X - кол-во байт выводимое на экран => наша нагрузка:
```
%500с%10$hhn
```
3. Ура! Скретный ключ у нас. Можно смело обменивать на флажок в банке! (функция chip_exchange() в помощь)

[Скрипт](../exploit/exploit.py) для решения задания.

```
vka{kazinblch_will_kill_you_but_not_today}
```