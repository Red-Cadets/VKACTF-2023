# Прилавок Аладдина

|   Cобытие   | Название | Категория | Сложность |
| :---------: | :------: | :-------: | :-------: |
| VKACTF 2023 |  Прилавок Аладдина  |  Pwn  |  Легкая  |

## Описание

>Автор: Ent3rG0dM0d3
>
>"В Агробе появилось злачное место, где каждый путник мог испытать удачу и выйграть несметные богатства. За прилавком стоял жулик Аладдин со своей проворной мартышкой. Попробуешь забрать богатства себе?"

# Решение

Дан 64-битный исполняемый файл, изучив который, можно увидеть следующее. В файле 4 функции: aladin_twist, crowd_help, leave_the_counter, cheat. Начнем попорядку:
1. aladin_twist - основная функция, выполнив которую до конца можно получить флаг. Для этого необходимо обойти функцию rand() 10 раз.
2. crowd_help - вспомогательная функция, которая записывает **\x00** по любому адресу в памяти.
3. cheat - ложная функция, которая сбивает с толку и при правильном ответе на вопрос выдает ложный флаг.
4. leave_the_counter - вспомогательная функция, c её помощью при ответе **no**, можно получить адрес функции **puts**.


- Первым делом определим версию библиотеки выполнив функцию **leave_the_counter** с ответом **no**, получим адрес функции **puts** при запуске файла. По трем последним байтам на **libc.blukat.me** получим необходимую библиотеку;
- С помощью полученной в предидущем шаге библиотеки вычисляем её базу (ликнутый адрес функции **puts** - смещение функции **puts** в библиотке);
- Найдя в библиотеке место, где находятся данные для функции rand(), сформируем цикл для перетирания значений по адресам с помощью функции **crowd_help**;
- После того как значения для функии rand() обращены в **\x00**, можно спокойно запускать функию **aladin_twist**, небоясь проиграть, и получаем заветный флажок.

[Скрипт](../exploit/exploit.py) для решения задания.

```
vka{whoever_has_the_gold_makes_the_rules}
```